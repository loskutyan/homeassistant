title: 'Главная'
icon: mdi:home-assistant

cards:
  - type: vertical-stack
    title: 'Дата и время'
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - type: custom:multiple-entity-row
            name: 'Сейчас'
            entity: sensor.date
            state_header: 'Дата'
            icon: mdi:calendar-clock
            entities:
            - entity: sensor.sun_next_rising
              format: relative
              hide_unavailable: true
            - entity: sensor.sun_next_setting
              format: relative
              hide_unavailable: true
            - entity: sensor.time
              name: 'Время'


  - type: vertical-stack
    title: 'Погода'
    cards:
      - type: weather-forecast
        entity: weather.yandex_weather


  - type: vertical-stack
    title: 'Статус'
    cards:
      - type: entities
        entities:
          - entity: switch.somebody_home
          - entity: switch.bedroom_asleep
          - entity: switch.kidsroom_asleep
          - entity: switch.warm_season

      - type: conditional
        conditions:
          - entity: binary_sensor.any_software_updates_available
            state: 'on'
        card:
          type: entities
          entities:
            - type: conditional
              conditions:
                - entity: binary_sensor.home_assistant_versions_update_available
                  state: 'on'
              row:
                type: custom:multiple-entity-row
                entity: sensor.current_version
                name: 'Версия Home Assistant'
                show_state: false
                entities:
                  - entity: sensor.current_version
                    name: 'Текущая'
                  - entity: sensor.home_assistant_versions
                    name: 'Последняя'
            - type: conditional
              conditions:
                - entity: binary_sensor.hacs_updates_available
                  state: 'on'
              row:
                entity: sensor.hacs
                name: 'Обновления HACS'

      - type: custom:auto-entities
        card:
          type: entities
        show_empty: false
        filter:
          include:
            - entity_id: sensor.*_filter_life_remaining_days
          exclude:
            - state: '> 30'

      - type: custom:auto-entities
        card:
          type: entities
        show_empty: false
        filter:
          include:
            - entity_id: sensor.*_battery
              options:
                type: custom:battery-entity-row
                secondary_info: last-changed
          exclude:
            - state: '> 30'

      - type: custom:auto-entities
        card:
          type: entities
        show_empty: false
        filter:
          include:
            - entity_id: sensor.vacuum_*_brush_left
            - entity_id: sensor.vacuum_filter_left
          exclude:
            - state: '> 25'


  - type: vertical-stack
    title: 'Климат и качество воздуха'
    cards:
      - type: custom:stack-in-card
        mode: vertical
        cards:
          - type: entities
            entities:
              - type: custom:multiple-entity-row
                name: 'Проветривание'
                entity: switch.bedroom_airpurifier_forced_ventilation
                show_state: false
                entities:
                  - icon: mdi:bed-king
                    state_color: true
                    name: 'Спальня'
                    tap_action:
                      action: toggle
                  
                  - icon: mdi:bed
                    state_color: true
                    name: 'Детская'
                    entity: switch.kidsroom_airpurifier_forced_ventilation
                    tap_action:
                      action: toggle
          
          - type: conditional
            conditions:
              - entity: switch.warm_season
                state: 'on'
            card:
              type: entities
              entities:
                - type: custom:multiple-entity-row
                  name: 'Охлаждение'
                  entity: switch.bedroom_cooling
                  show_state: false
                  entities:
                    - icon: mdi:bed-king
                      state_color: true
                      name: 'Спальня'
                      tap_action:
                        action: toggle
                    
                    - icon: mdi:bed
                      state_color: true
                      name: 'Детская'
                      entity: switch.kidsroom_cooling
                      tap_action:
                        action: toggle

      - type: conditional
        conditions:
          - entity: switch.warm_season
            state: 'on'
        card:
          type: custom:mini-graph-card
          entities:
            - entity: sensor.bedroom_average_temperature
              name: 'Температура в спальне'
              show_legend: false
            - entity: sensor.kidsroom_average_temperature
              name: 'Температура в детской'
              show_legend: false
          lower_bound: 18
          upper_bound: 32
          color_thresholds:
            - value: 21
              color: '#00FFFF'
            - value: 23
              color: '#00FF00'
            - value: 25
              color: '#FFFF00'
            - value: 27
              color: '#FFD700'
            - value: 29
              color: '#FF0000'
            - value: 35
              color: '#800000'
          animate: true
          line_width: 2
          hour24: true
          points_per_hour: 1
          group_by: hour

      - type: custom:mini-graph-card
        entities:
          - entity: sensor.cleargrass_air_co2
            name: 'CO² Спальня'
            show_legend: false
          - entity: sensor.qingping_air_lite_co2
            name: 'CO² Детская'
            show_legend: false
        lower_bound: 400
        upper_bound: 1200
        color_thresholds:
          - value: 450
            color: '#00FFFF'
          - value: 600
            color: '#00FF00'
          - value: 800
            color: '#FFFF00'
          - value: 1000
            color: '#FFD700'
          - value: 1200
            color: '#FF0000'
          - value: 9999
            color: '#800000'
        animate: true
        line_width: 2
        hour24: true
        points_per_hour: 1
        group_by: hour

      - type: horizontal-stack
        cards:
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.cleargrass_air_pm25
                name: 'PM2.5 Спальня'
                show_legend: false
              - entity: sensor.qingping_air_lite_pm25
                name: 'PM2.5 Детская'
                show_legend: false
            lower_bound: 0.0
            upper_bound: 20.0
            color_thresholds:
              - value: 1
                color: '#00FFFF'
              - value: 3
                color: '#00FF00'
              - value: 10
                color: '#FFFF00'
              - value: 25
                color: '#FFD700'
              - value: 75
                color: '#FF0000'
              - value: 999
                color: '#800000'
            animate: true
            line_width: 2
            hour24: true
            points_per_hour: 1
            group_by: hour

          - type: custom:mini-graph-card
            entities:
              - entity: sensor.cleargrass_air_tvoc
                name: 'tVOC'
            lower_bound: 0
            upper_bound: 500
            color_thresholds:
              - value: 60
                color: '#00FFFF'
              - value: 100
                color: '#00FF00'
              - value: 200
                color: '#FFFF00'
              - value: 500
                color: '#FF0000'
            animate: true
            line_width: 2
            hour24: true
            points_per_hour: 1
            group_by: hour


  - type: vertical-stack
    title: 'Aqara Hub'
    cards:
      - type: entities
        entities:
          - entity: input_number.aqara_hub_volume
            type: custom:slider-entity-row
            name: 'Громкость'
            step: 2
            hide_state: false
          - entity: light.miio_gateway
            type: custom:slider-entity-row
            name: 'Яркость'
            step: 1
